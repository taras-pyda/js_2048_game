{"version":3,"sources":["scripts/main.js"],"names":["button","document","querySelector","messages","querySelectorAll","score","directions","game","cells","field","children","getRandomNumber","number","Math","floor","random","generateRandomCell","luckyNumber","randomRow","fieldArr","length","randomCell","textContent","i","j","arrItem","cell","className","classList","remove","body","removeEventListener","start","move","direction","fieldPart","filteredPart","filter","emptyStringsNumber","emptyStrings","Array","fill","newFieldPart","concat","combineRow","row","combineColumn","canMoveRight","canMoveLeft","canMoveUp","column","canMoveDown","checkForLose","e","code","addEventListener","add","forEach","message"],"mappings":"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","file":"main.c7ff0f9a.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\n\nconst button = document.querySelector('.button');\nconst messages = document.querySelectorAll('.message');\nconst score = document.querySelector('.game-score');\nconst directions = ['right', 'left', 'up', 'down'];\nconst game = {\n  cells: document.querySelectorAll('.field-cell'),\n  field: document.querySelector('tbody').children,\n  score: 0,\n\n  getRandomNumber(number) {\n    return Math.floor(Math.random() * number);\n  },\n\n  generateRandomCell() {\n    const luckyNumber = this.getRandomNumber(10);\n    const randomRow = this.getRandomNumber(this.fieldArr.length);\n    const randomCell = this.getRandomNumber(this.fieldArr.length);\n\n    if (this.fieldArr[randomRow][randomCell] === '') {\n      this.fieldArr[randomRow][randomCell] = (luckyNumber === 4)\n        ? 4\n        : 2;\n\n      score.textContent = this.score;\n\n      for (let i = 0; i < this.fieldArr.length; i++) {\n        for (let j = 0; j < this.fieldArr.length; j++) {\n          const arrItem = this.fieldArr[i][j];\n          const cell = this.field[i].children[j];\n\n          cell.textContent = arrItem;\n\n          cell.className = (arrItem === '')\n            ? 'field-cell'\n            : `field-cell field-cell--${arrItem}`;\n\n          if (arrItem === 2048) {\n            messages[1].classList.remove('hidden');\n\n            document.body.removeEventListener('keydown', game.start);\n          }\n        }\n      }\n    } else {\n      this.generateRandomCell();\n    }\n  },\n\n  move(direction) {\n    for (let i = 0; i < this.fieldArr.length; i++) {\n      const fieldPart = (direction === directions[0]\n        || direction === directions[1])\n        ? this.fieldArr[i]\n        : [\n          this.fieldArr[0][i],\n          this.fieldArr[1][i],\n          this.fieldArr[2][i],\n          this.fieldArr[3][i],\n        ];\n\n      const filteredPart = fieldPart.filter(number => number);\n      const emptyStringsNumber = fieldPart.length - filteredPart.length;\n      const emptyStrings = Array(emptyStringsNumber).fill('');\n      const newFieldPart = (direction === directions[0]\n        || direction === directions[3])\n        ? emptyStrings.concat(filteredPart)\n        : filteredPart.concat(emptyStrings);\n\n      if (direction === directions[0] || direction === directions[1]) {\n        this.fieldArr[i] = newFieldPart;\n      }\n\n      if (direction === directions[2] || direction === directions[3]) {\n        this.fieldArr[0][i] = newFieldPart[0];\n        this.fieldArr[1][i] = newFieldPart[1];\n        this.fieldArr[2][i] = newFieldPart[2];\n        this.fieldArr[3][i] = newFieldPart[3];\n      }\n    }\n  },\n\n  combineRow() {\n    for (let i = 0; i < this.fieldArr.length; i++) {\n      const row = this.fieldArr[i];\n\n      for (let j = 0; j < row.length - 1; j++) {\n        if (row[j] > 0 && row[j] === row[j + 1]) {\n          row[j] *= 2;\n\n          this.score += row[j];\n          row[j + 1] = '';\n        }\n      }\n    }\n  },\n\n  combineColumn() {\n    for (let i = 0; i < this.fieldArr.length - 1; i++) {\n      for (let j = 0; j < this.fieldArr[i].length; j++) {\n        if (+this.fieldArr[i][j] > 0\n            && this.fieldArr[i][j] === this.fieldArr[i + 1][j]) {\n          this.fieldArr[i][j] *= 2;\n\n          this.score += this.fieldArr[i][j];\n          this.fieldArr[i + 1][j] = '';\n        }\n      }\n    }\n  },\n\n  canMoveRight() {\n    for (let i = 0; i < this.fieldArr.length; i++) {\n      const row = this.fieldArr[i];\n\n      for (let j = 0; j < row.length - 1; j++) {\n        if ((!!row[j] && row[j] === row[j + 1]) || (!!row[j] && !row[j + 1])) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  },\n\n  canMoveLeft() {\n    for (let i = 0; i < this.fieldArr.length; i++) {\n      const row = this.fieldArr[i];\n\n      for (let j = 1; j < row.length; j++) {\n        if ((row[j] && row[j] === row[j - 1]) || (row[j] && !row[j - 1])) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  },\n\n  canMoveUp() {\n    for (let i = 0; i < this.fieldArr.length; i++) {\n      const column = [\n        this.fieldArr[0][i],\n        this.fieldArr[1][i],\n        this.fieldArr[2][i],\n        this.fieldArr[3][i],\n      ];\n\n      for (let j = 1; j < column.length; j++) {\n        if ((column[j] && column[j] === column[j - 1])\n        || (column[j] && !column[j - 1])) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  },\n\n  canMoveDown() {\n    for (let i = 0; i < this.fieldArr.length; i++) {\n      const column = [\n        this.fieldArr[0][i],\n        this.fieldArr[1][i],\n        this.fieldArr[2][i],\n        this.fieldArr[3][i],\n      ];\n\n      for (let j = 0; j < column.length - 1; j++) {\n        if ((column[j] && column[j] === column[j + 1])\n        || (column[j] && !column[j + 1])) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  },\n\n  checkForLose() {\n    if (!game.canMoveDown()\n        && !game.canMoveUp()\n        && !game.canMoveRight()\n        && !game.canMoveLeft()) {\n      messages[0].classList.remove('hidden');\n\n      document.body.removeEventListener('keydown', game.start);\n\n      return true;\n    }\n\n    return false;\n  },\n\n  start(e) {\n    switch (e.code) {\n      case 'ArrowRight':\n        if (game.canMoveRight()) {\n          game.move(directions[0]);\n          game.combineRow();\n          game.move(directions[0]);\n          game.generateRandomCell();\n        }\n        game.checkForLose();\n        break;\n\n      case 'ArrowLeft':\n        if (game.canMoveLeft()) {\n          game.move(directions[1]);\n          game.combineRow();\n          game.move(directions[1]);\n          game.generateRandomCell();\n        }\n        game.checkForLose();\n        break;\n\n      case 'ArrowUp':\n        if (game.canMoveUp()) {\n          game.move(directions[2]);\n          game.combineColumn();\n          game.move(directions[2]);\n          game.generateRandomCell();\n        }\n        game.checkForLose();\n        break;\n\n      case 'ArrowDown':\n        if (game.canMoveDown()) {\n          game.move(directions[3]);\n          game.combineColumn();\n          game.move(directions[3]);\n          game.generateRandomCell();\n        }\n        game.checkForLose();\n        break;\n    }\n  },\n};\n\nbutton.addEventListener('click', () => {\n  game.fieldArr = [\n    ['', '', '', ''],\n    ['', '', '', ''],\n    ['', '', '', ''],\n    ['', '', '', ''],\n  ];\n  button.classList.remove('start');\n  button.classList.add('restart');\n  button.textContent = 'Restart';\n  messages.forEach(message => message.classList.add('hidden'));\n  game.score = 0;\n  game.generateRandomCell();\n  game.generateRandomCell();\n\n  document.body.addEventListener('keydown', game.start);\n});\n"]}